# K-memo功能模块文档

**文档编号：** [000]  
**文档类型：** 核心文档 - 功能模块总览  
**创建时间：** 2025-10-25  
**最后更新：** 2025-10-25  
**维护要求：** 每次完成新功能模块或修改现有模块后必须更新此文档  

---

## 文档说明

本文档是K-memo项目的功能模块总览文档，记录了所有已实现、开发中和计划中的功能模块。每个功能模块包含其当前状态、核心功能、相关文件和责任人信息。

**维护规则：**
- 完成新功能模块后，在"已实现模块"中添加详细信息
- 修改现有模块功能时，更新对应模块的描述和更新时间
- 每个模块必须标注当前状态、最后更新时间和版本号

---

## 模块状态说明

| 状态标识 | 说明 |
|---------|------|
| ✅ 已完成 | 功能已完整实现并通过测试 |
| 🚧 开发中 | 功能正在开发，部分功能可用 |
| 📋 计划中 | 已规划但尚未开始开发 |
| 🔄 重构中 | 已有实现但正在重构优化 |
| ⚠️ 需修复 | 存在已知问题，需要修复 |

---

## 一、核心业务模块

### 1.1 任务管理模块 ✅

**模块状态：** 已完成  
**版本号：** v1.0  
**最后更新：** 2025-09-21  

**核心功能：**
- 任务创建、编辑、删除（完整CRUD操作）
- 任务状态管理（待办、进行中、已完成、已取消）
- 任务优先级设置（低、普通、高、紧急）
- 任务分类和标签系统
- 任务截止时间设置
- 任务提醒功能

**相关文件：**
- `k-memo/models/task.h/.cpp` - Task实体类
- `k-memo/models/taskmodel.h/.cpp` - TaskModel数据模型
- `k-memo/TaskDetailWidget.h/.cpp` - 任务详情组件
- `k-memo/QuickAddWidget.h/.cpp` - 快速添加组件

**数据库表：**
- `tasks` - 任务主表
- `task_tags` - 任务标签关联表

**API接口：**
- `Task::Task()` - 任务对象构造
- `Task::toJson()` - 任务序列化
- `Task::fromJson()` - 任务反序列化
- `Task::validate()` - 任务数据验证

**已知问题：** 无

---

### 1.2 数据持久化模块 ✅

**模块状态：** 已完成  
**版本号：** v1.0  
**最后更新：** 2025-09-19  

**核心功能：**
- SQLite数据库初始化和版本管理
- 任务数据的增删改查操作
- 标签数据管理
- 数据库备份和恢复
- 数据迁移机制

**相关文件：**
- `k-memo/database/databasemanager.h/.cpp` - 数据库管理器（单例模式）

**数据库表：**
- `tasks` - 任务表
- `task_tags` - 标签关联表
- `app_config` - 应用配置表

**API接口：**
- `DatabaseManager::instance()` - 获取单例实例
- `DatabaseManager::insertTask()` - 插入任务
- `DatabaseManager::updateTask()` - 更新任务
- `DatabaseManager::deleteTask()` - 删除任务
- `DatabaseManager::getTask()` - 查询单个任务
- `DatabaseManager::getAllTasks()` - 查询所有任务
- `DatabaseManager::getTasksByCategory()` - 按分类查询
- `DatabaseManager::getTasksByStatus()` - 按状态查询

**已知问题：** 无

---

### 1.3 分类和标签系统 ✅

**模块状态：** 已完成  
**版本号：** v1.0  
**最后更新：** 2025-09-21  

**核心功能：**
- 任务分类管理（工作、学习、个人等）
- 自定义分类创建和删除
- 多标签支持
- 标签自动完成
- 按分类和标签筛选任务

**相关文件：**
- `k-memo/database/databasemanager.h/.cpp` - 分类和标签数据操作
- `k-memo/models/taskmodel.h/.cpp` - 分类标签数据模型

**API接口：**
- `DatabaseManager::getAllCategories()` - 获取所有分类
- `DatabaseManager::getAllTags()` - 获取所有标签
- `DatabaseManager::addTagToTask()` - 为任务添加标签
- `DatabaseManager::removeTagFromTask()` - 移除任务标签

**已知问题：** 无

---

## 二、系统集成模块

### 2.1 系统托盘模块 ✅

**模块状态：** 已完成  
**版本号：** v1.0  
**最后更新：** 2025-09-21  

**核心功能：**
- 系统托盘图标显示
- 托盘图标显示待办任务数量
- 托盘右键菜单
- 双击托盘显示/隐藏主窗口
- 最小化到托盘功能

**相关文件：**
- `k-memo/managers/traymanager.h/.cpp` - 系统托盘管理器

**API接口：**
- `TrayManager::TrayManager()` - 托盘管理器构造
- `TrayManager::updateTaskCount()` - 更新任务计数显示
- `TrayManager::show()` - 显示托盘图标

**已知问题：** 无

---

### 2.2 通知系统模块 ✅

**模块状态：** 已完成  
**版本号：** v1.0  
**最后更新：** 2025-09-22  

**核心功能：**
- 任务到期提醒
- 自定义提醒时间
- Windows系统通知集成
- 提醒记录管理

**相关文件：**
- `k-memo/managers/notificationmanager.h/.cpp` - 通知管理器

**API接口：**
- `NotificationManager::NotificationManager()` - 通知管理器构造
- `NotificationManager::showNotification()` - 显示通知
- `NotificationManager::scheduleReminder()` - 安排提醒

**技术实现：**
- 基于QSystemTrayIcon的通知功能
- 后期可扩展Windows Toast通知API

**已知问题：** 无

---

## 三、用户界面模块

### 3.1 主窗口模块 ✅

**模块状态：** 已完成（准备重构）  
**版本号：** v1.0  
**最后更新：** 2025-09-22  

**核心功能：**
- 应用主界面布局
- 菜单栏和工具栏
- 状态栏显示
- 窗口状态管理
- 快捷键支持

**相关文件：**
- `k-memo/kmemo.h/.cpp/.ui` - 主窗口类
- `k-memo/main.cpp` - 应用程序入口

**API接口：**
- `KMemo::KMemo()` - 主窗口构造
- `KMemo::showWindow()` - 显示窗口
- `KMemo::hideWindow()` - 隐藏窗口

**计划重构：**
- 将采用移动风格的简化界面设计
- 三卡片布局（统计、添加、列表）
- 见任务5.1（UI重构阶段）

---

### 3.2 任务详情组件 ✅

**模块状态：** 已完成  
**版本号：** v1.0  
**最后更新：** 2025-09-22  

**核心功能：**
- 任务详细信息显示
- 任务编辑界面
- 分类和标签选择
- 优先级和状态设置
- 截止时间设置

**相关文件：**
- `k-memo/TaskDetailWidget.h/.cpp` - 任务详情组件

**API接口：**
- `TaskDetailWidget::setTask()` - 设置当前任务
- `TaskDetailWidget::getTask()` - 获取任务数据
- `TaskDetailWidget::save()` - 保存修改

---

### 3.3 统计信息组件 ✅

**模块状态：** 已完成  
**版本号：** v1.0  
**最后更新：** 2025-09-22  

**核心功能：**
- 任务统计信息显示
- 待办任务计数
- 已完成任务计数
- 各优先级任务分布
- 各状态任务分布

**相关文件：**
- `k-memo/TaskStatsWidget.h/.cpp` - 统计信息组件

**API接口：**
- `TaskStatsWidget::updateStats()` - 更新统计数据
- `TaskStatsWidget::setModel()` - 设置数据模型

---

### 3.4 快速添加组件 ✅

**模块状态：** 已完成  
**版本号：** v1.0  
**最后更新：** 2025-09-22  

**核心功能：**
- 快速创建新任务
- 简化的输入界面
- 基本任务信息输入
- 快捷键支持

**相关文件：**
- `k-memo/QuickAddWidget.h/.cpp` - 快速添加组件

**API接口：**
- `QuickAddWidget::clear()` - 清空输入
- `QuickAddWidget::getTaskTitle()` - 获取任务标题
- `QuickAddWidget::createTask()` - 创建新任务

---

### 3.5 简化界面组件 🚧

**模块状态：** 开发中  
**版本号：** v0.5  
**最后更新：** 2025-10-25  

**核心功能：**
- SimpleAddWidget - 简化的任务添加卡片
- SimpleTaskListWidget - 简化的任务列表卡片
- 移动风格的UI设计
- 一键完成任务

**相关文件：**
- `k-memo/widgets/simple/simpleaddwidget.h/.cpp/.ui` - 简化添加组件
- `k-memo/widgets/simple/simpletasklistwidget.h/.cpp/.ui` - 简化列表组件

**开发进度：**
- [x] 创建基础UI文件结构
- [ ] 实现SimpleAddWidget功能
- [ ] 实现SimpleTaskListWidget功能
- [ ] 集成到主界面

**计划完成时间：** 2025-10-28

---

## 四、辅助工具模块

### 4.1 图标管理模块 ✅

**模块状态：** 已完成  
**版本号：** v1.0  
**最后更新：** 2025-09-22  

**核心功能：**
- SVG图标统一加载
- 图标分类管理
- 图标缓存机制
- 动态图标切换

**相关文件：**
- `k-memo/IconManager.h/.cpp` - 图标管理器
- `k-memo/icons/` - 图标资源目录

**图标分类：**
- `actions/` - 操作图标（添加、删除、编辑等）
- `categories/` - 分类图标（工作、学习、个人等）
- `priority/` - 优先级图标（低、普通、高、紧急）
- `status/` - 状态图标（待办、进行中、已完成、已取消）
- `ui/` - 界面图标（折叠、主题等）

**API接口：**
- `IconManager::instance()` - 获取单例实例
- `IconManager::getIcon()` - 加载指定图标
- `IconManager::getPriorityIcon()` - 获取优先级图标
- `IconManager::getStatusIcon()` - 获取状态图标

---

## 五、计划中的模块

### 5.1 搜索和过滤模块 📋

**模块状态：** 已取消  
**取消原因：** 用户确认移除此功能  
**取消时间：** 2025-09-17  

~~原计划功能：全文搜索、多条件过滤、复合搜索~~

---

### 5.2 主题定制模块 📋

**模块状态：** 已取消  
**取消原因：** 用户确认移除此功能  
**取消时间：** 2025-09-17  

~~原计划功能：明暗主题切换、自定义颜色方案~~

---

### 5.3 云同步模块 📋

**模块状态：** 计划中（第二阶段）  
**计划时间：** 待定  

**计划功能：**
- 用户注册和登录
- 任务数据云端同步
- 多设备数据共享
- 冲突解决机制

**技术选型：**
- 待定（可能采用RESTful API + JWT认证）

---

### 5.4 数据分析模块 📋

**模块状态：** 计划中（第二阶段）  
**计划时间：** 待定  

**计划功能：**
- 任务完成率统计
- 工作效率分析
- 时间分布图表
- 生产力报告

---

## 六、技术架构模块

### 6.1 MVC架构 ✅

**实现状态：** 已完成  

**架构分层：**
- **Model层：** `models/task.h`, `models/taskmodel.h`
- **View层：** `kmemo.ui`, `widgets/`目录下的UI组件
- **Controller层：** `kmemo.cpp`, 各组件的`.cpp`实现文件

**数据流：**
```
UI Layer (kmemo.cpp/ui)
    ↕ (Qt Signals/Slots)
Model Layer (TaskModel)
    ↕ (Database Signals)
Database Layer (DatabaseManager - Singleton)
    ↕ (SQLite Operations)
SQLite Database (Local Storage)
```

---

### 6.2 单例模式 ✅

**应用场景：**
- DatabaseManager - 数据库连接管理
- IconManager - 图标资源管理
- TrayManager - 系统托盘管理
- NotificationManager - 通知管理

**实现方式：**
```cpp
static ClassName* instance();
private:
    static ClassName* m_instance;
    ClassName();  // 私有构造函数
```

---

## 七、模块依赖关系图

```
主应用程序 (main.cpp)
    └─> 主窗口 (KMemo)
        ├─> 任务模型 (TaskModel)
        │   └─> 数据库管理器 (DatabaseManager)
        │       └─> SQLite数据库
        ├─> 托盘管理器 (TrayManager)
        ├─> 通知管理器 (NotificationManager)
        ├─> 图标管理器 (IconManager)
        └─> UI组件
            ├─> TaskDetailWidget
            ├─> TaskStatsWidget
            ├─> QuickAddWidget
            └─> Simple组件 (开发中)
```

---

## 八、模块更新日志

### 2025-10-25
- **[新增]** 创建功能模块文档（本文档）
- **[更新]** 完善各模块状态和API信息

### 2025-09-22
- **[新增]** 图标管理模块
- **[新增]** 任务详情组件
- **[新增]** 统计信息组件
- **[新增]** 快速添加组件
- **[完成]** 全面中文本地化

### 2025-09-21
- **[完成]** 任务管理模块
- **[完成]** 分类和标签系统
- **[完成]** 系统托盘模块

### 2025-09-19
- **[完成]** 数据持久化模块

### 2025-09-17
- **[取消]** 搜索和过滤模块（用户确认移除）
- **[取消]** 主题定制模块（用户确认移除）

---

## 九、模块统计

| 类别 | 已完成 | 开发中 | 计划中 | 已取消 | 合计 |
|-----|-------|-------|-------|-------|------|
| 核心业务 | 3 | 0 | 0 | 0 | 3 |
| 系统集成 | 2 | 0 | 0 | 0 | 2 |
| 用户界面 | 4 | 1 | 0 | 0 | 5 |
| 辅助工具 | 1 | 0 | 0 | 0 | 1 |
| 未来扩展 | 0 | 0 | 2 | 2 | 4 |
| **总计** | **10** | **1** | **2** | **2** | **15** |

**完成率：** 10/13 = 76.9% （不含已取消模块）

---

## 十、维护指南

### 更新频率
- **必须更新：** 完成新功能模块或修改现有模块时
- **建议更新：** 每周审查一次，确保文档与代码同步

### 更新流程
1. 在对应模块章节更新信息
2. 更新"最后更新"时间
3. 在"模块更新日志"中记录变更
4. 更新"模块统计"表格

### 相关文档
- `[001]K-memo桌面便签应用开发计划.md` - 项目总体计划
- `[002]K-memo方案二详细实施计划.md` - 详细实施计划
- `[003]数据库设计文档.md` - 数据库设计详细说明
- `[004]API接口文档.md` - 各模块API详细文档
- `[005]项目架构文档.md` - 技术架构设计文档

---

**文档维护人：** AI开发助手  
**审核人：** 项目负责人  
**下次审查时间：** 2025-11-01

